!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}var e=c(1),f=d(e),g=c(4),h=d(g),i=c(5),j=d(i),k=c(6),l=d(k),m=new f["default"]({container:"#board",columns:5,rows:5}),n=new h["default"]({name:"Roomba"}),o=new j["default"](n),p=new l["default"](n);document.addEventListener("DOMContentLoaded",function(){m.createCanvas(),m.layout(),m.listen(),n.connectTo(m),n.listen(),o.listen(),p.listen()})},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(2),h=d(g),i=c(3),j=d(i);Object.freeze(h["default"]);var k=null,l=null,m=function(){function a(b){e(this,a),j["default"](this,h["default"].grid,b),this.el=document.querySelector(this.container),this.offsetX=0,this.offsetY=0}return f(a,[{key:"layout",value:function(){if(!this.ctx||!this.ctx instanceof CanvasRenderingContext2D)throw new Error("Grid.ctx is not a canvas element");for(var a=0;a<this.rows;a++)for(var b=0;b<this.columns;b++)this.draw(b,a)}},{key:"createCanvas",value:function(){this.canvas=document.createElement("canvas"),this.el.appendChild(this.canvas),this.canvas.draggable=!0,this.canvas.width=this.columns*this.size,this.canvas.height=this.rows*this.size,this.ctx=this.canvas.getContext("2d")}},{key:"draw",value:function(a,b){this.ctx.moveTo(a*this.size,b*this.size),this.ctx.strokeRect(a*this.size,b*this.size,a*this.size+this.size,b*this.size+this.size)}},{key:"checkTouch",value:function(a){return a.changedTouches?a.changedTouches[0]:a}},{key:"startRotate",value:function(a){a.target===this.canvas&&(a.preventDefault(),k=this.checkTouch(a).pageX-this.offsetX,l=this.checkTouch(a).pageY-this.offsetY,document.documentElement.setAttribute("data-dragging",""))}},{key:"stopRotate",value:function(a){(k||l)&&(k=null,l=null,document.documentElement.removeAttribute("data-dragging"))}},{key:"rotate",value:function(a){a.preventDefault(),k&&l&&(this.offsetX=this.clamp(this.checkTouch(a).pageX-k,60),this.offsetY=this.clamp(this.checkTouch(a).pageY-l,60),this.canvas.parentNode.style.transform="perspective(1000px) rotateX("+this.offsetY+"deg) rotateZ("+this.offsetX+"deg)")}},{key:"clamp",value:function(a,b){return a>b?b:-b>a?-b:a}},{key:"listen",value:function(){document.addEventListener("mousedown",this.startRotate.bind(this)),document.addEventListener("mousemove",this.rotate.bind(this)),document.addEventListener("mouseup",this.stopRotate.bind(this)),document.addEventListener("touchstart",this.startRotate.bind(this)),document.addEventListener("touchmove",this.rotate.bind(this)),document.addEventListener("touchend",this.stopRotate.bind(this))}}]),a}();b["default"]=m,a.exports=b["default"]},function(a,b,c){a.exports={grid:{container:"body",rows:5,columns:5,size:100},robot:{name:"Robot",speed:1e3,position:{x:0,y:0,f:"NORTH"},sounds:{move:"",rotate:""}},increment:90,headings:{NORTH:{r:0,x:0,y:1},EAST:{r:90,x:1,y:0},SOUTH:{r:180,x:0,y:-1},WEST:{r:270,x:-1,y:0}},mappings:{32:{command:"place"},37:{command:"rotate",arguments:["left"]},38:{command:"move"},39:{command:"rotate",arguments:["right"]}}}},function(a,b,c){"use strict";function d(a){if(null==a)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}a.exports=Object.assign||function(a,b){for(var c,e,f=d(a),g=1;g<arguments.length;g++){c=arguments[g],e=Object.keys(Object(c));for(var h=0;h<e.length;h++)f[e[h]]=c[e[h]]}return f}},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(2),h=d(g),i=c(1),j=d(i),k=c(3),l=d(k);Object.freeze(h["default"]);var m=function(){function a(b){e(this,a),l["default"](this,h["default"].robot,b),this.placed=!1,this.moving=!1,this.robot=null,this.queue=[]}return f(a,[{key:"render",value:function(){this.robot=document.createElement("div"),this.robot.id="robot",this.grid.el.appendChild(this.robot)}},{key:"animate",value:function(){this.robot.style.transform="translate3d("+this.position.x*this.grid.size+"px, -"+this.position.y*this.grid.size+"px, 0) rotate("+this.position.a+"deg)",this.robot.setAttribute("data-heading",this.position.f.toLowerCase())}},{key:"connectTo",value:function(a){if(a instanceof j["default"]==!1)throw new Error("first argument must be a grid instance");this.grid=a}},{key:"validateX",value:function(a){return"number"==typeof a&&a<this.grid.columns&&a>=0?!0:!1}},{key:"validateY",value:function(a){return"number"==typeof a&&a<this.grid.rows&&a>=0?!0:!1}},{key:"validateF",value:function(a){return"string"==typeof a&&"object"==typeof h["default"].headings[a]?!0:!1}},{key:"place",value:function(){var a=void 0===arguments[0]?0:arguments[0],b=void 0===arguments[1]?0:arguments[1],c=void 0===arguments[2]?"NORTH":arguments[2];this.position.x=this.validateX(a)?a:h["default"].robot.position.x,this.position.y=this.validateY(b)?b:h["default"].robot.position.y,this.position.f=this.validateF(c)?c:h["default"].robot.position.f,this.position.r=this.validateF(c)?h["default"].headings[c].r:h["default"].headings[h["default"].robot.position.f].r,this.position.a=this.validateF(c)?h["default"].headings[c].r:h["default"].headings[h["default"].robot.position.f].r,this.placed===!1&&(this.render(),this.placed=!0),this.animate()}},{key:"report",value:function(){var a={X:this.position.x,Y:this.position.y,F:this.position.f};console.log(a)}},{key:"move",value:function(){if(this.placed!==!0)throw new Error(this.name+" has not been placed.");var a=h["default"].headings[this.position.f];this.position.x=this.validateX(this.position.x+a.x)?this.position.x+a.x:this.position.x,this.position.y=this.validateY(this.position.y+a.y)?this.position.y+a.y:this.position.y,this.animate()}},{key:"rotate",value:function(a){if(this.placed!==!0)throw new Error(this.name+" has not been placed.");"left"===a?(this.position.a-=h["default"].increment,this.position.r-=h["default"].increment,this.position.r<0?this.position.r+=360:this.position.r>=360&&(this.position.r-=360)):"right"===a&&(this.position.a+=h["default"].increment,this.position.r+=h["default"].increment,this.position.r<0?this.position.r+=360:this.position.r>=360&&(this.position.r-=360));for(var b in h["default"].headings)this.position.r===h["default"].headings[b].r&&(this.position.f=b);this.animate()}},{key:"listen",value:function(){document.addEventListener("keydown",this.handleKeypress.bind(this))}},{key:"handleKeypress",value:function(a){var b=h["default"].mappings[a.which];if(this.moving===!1&&b&&"function"==typeof this[b.command]){a.preventDefault();b.arguments||[];this[b.command].apply(this,b.arguments)}}}]),a}();b["default"]=m,a.exports=b["default"]},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(4),h=d(g),i=function(){function a(b){if(e(this,a),!b instanceof h["default"])throw new Error("Parser needs to connect to an instantiated robot")}return f(a,[{key:"load",value:function(a){}},{key:"parse",value:function(){}},{key:"listen",value:function(){}}]),a}();b["default"]=i,a.exports=b["default"]},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(7),h=d(g),i=c(4),j=d(i),k=function(){function a(b){if(e(this,a),!b instanceof j["default"])throw new Error("Parser needs to connect to an instantiated robot");this.mumble=new h["default"]({language:"en-GB",debug:!1,commands:[{name:"place",command:/^place$/,action:function(){b.place()}},{name:"place_at",command:/^place X(.+) Y(.+) (North|East|South|West)$/,action:function(a,c,d){b.place(parseInt(a),parseInt(c),d.toUpperCase())}},{name:"move",command:/^move$/,action:function(){b.move()}},{name:"left",command:/^left$/,action:function(){b.rotate("left")}},{name:"right",command:/^right$/,action:function(){b.rotate("right")}}]})}return f(a,[{key:"listen",value:function(){this.mumble.start()}}]),a}();b["default"]=k,a.exports=b["default"]},function(a,b,c){!function(b,c){a.exports=c()}("Mumble",function(){"use strict";var a=function(a){function b(a){if(j=h(),o.isAvailable()){if(a)for(var b in n)a[b]&&(n[b]=a[b]);o.setLanguage(n.language),o.setContinuous(n.continuous),o.setAutoRestart(n.autoRestart),o.setMaxAlternatives(n.maxAlternatives),o.setDebug(n.debug),n.commands.forEach(function(a){o.addCommand(a.name,a.command,a.action)}),j.onstart=c,j.onend=d,j.onerror=e,j.onresult=f}}function c(a){i("Start listening..",a,n),g(n.callbacks.start,a,o)}function d(a){if(i("Stop listening..",a),g(n.callbacks.end,a,o),n.autoRestart&&!l){i("(Auto-restarting)");var b=(new Date).getTime()-k;1e3>b?setTimeout(o.start,1e3-b):o.start()}}function e(a){i("Error occurred",a),g(n.callbacks.error,a,o),-1!==["not-allowed","service-not-allowed"].indexOf(a.error)&&o.setAutoRestart(!1)}function f(a){i("Got result",a),g(n.callbacks.speech,a,o);for(var b=a.results[a.resultIndex],c=!1,d=0;d<b.length;d++){var e=b[d],f=e.transcript.trim();if(i('Recognized: "%s"',f),c=m.some(function(b){var c=b.command.exec(f);if(c){var d=c.slice(1);return i('Command matched: "%s", %s',b.name,b.command,d),g(n.callbacks.recognizeMatch,a,o),b.action.apply(o,d),!0}return!1}))break}return c||g(n.callbacks.recognizeNoMatch,a,o),c}function g(a,b,c){"function"==typeof a&&a.call(c,b)}function h(){var a=window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition;return a?new a:(i("SpeechRecognition object not supported"),null)}function i(){if(n.debug){var a=window.console||{log:function(){}};a.log.apply(a,arguments)}}var j=null,k=0,l=!1,m=[],n={language:"en-US",autoRestart:!0,continuous:"http:"===window.location.protocol,maxAlternatives:5,debug:!1,commands:[],callbacks:{start:null,end:null,speech:null,recognizeMatch:null,recognizeNoMatch:null,error:null}},o=this;this.start=function(){if(!this.isAvailable())throw"Speech recognition not supported in this browser";l=!1,k=(new Date).getTime(),i("Starting with %d command(s) active",m.length),j.start()},this.stop=function(){this.isAvailable()&&(l=!0,j.abort())},this.isAvailable=function(){return!!j},this.getSpeechRecognitionObject=function(){return j},this.addCommand=function(a,b,c){if(this.getCommand(a))throw'Command "'+a+'"" already exists';var d="string"==typeof b?"^"+b+"$":b.source,e=new RegExp(d,"i");m.push({name:a,command:e,action:c}),i('Added command: "%s", %s',a,e)},this.removeCommand=function(a){var b=-1;m.some(function(c,d){return c.name==a?(b=d,!0):!1}),b>=0&&(delete m[b],i('Removed command "%s"',a))},this.getCommand=function(a){var b=null;return m.some(function(c){return c.name==a?(b=c,!0):!1}),b},this.setLanguage=function(a){n.language=a,this.isAvailable()&&(j.lang=n.language)},this.setAutoRestart=function(a){n.autoRestart=!!a},this.setMaxAlternatives=function(a){n.maxAlternatives=parseInt(a),this.isAvailable()&&(j.maxAlternatives=n.maxAlternatives)},this.setContinuous=function(a){n.continuous=!!a,this.isAvailable()&&(j.continuous=n.continuous)},this.setDebug=function(a){n.debug=!!a},b(a)};return a})}]);