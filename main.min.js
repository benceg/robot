!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}var e=c(5),f=d(e),g=c(4),h=d(g),i=c(7),j=d(i),k=c(1),l=d(k),m=c(8),n=d(m),o=c(9),p=d(o),q=new f["default"]({container:"#board",columns:5,rows:5}),r=new h["default"]({name:"Roomba"}),s=new j["default"]("#report"),t=new l["default"](r);new n["default"](r);document.addEventListener("DOMContentLoaded",function(){p["default"].attach(document.body),q.createCanvas(),q.layout(),q.listen(),r.connectTo(q),r.listen(),t.listen(),s.listen()})},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(2),h=d(g),i=c(3),j=(d(i),c(4)),k=d(j);Object.freeze(h["default"]);var l=function(){function a(b){if(e(this,a),!b instanceof k["default"])throw new Error("Parser needs to connect to an instantiated robot");this.queue=[],this.robot=b,this.commands=this.robot.registerCommands(),this.digesting=!0,this.digest()}return f(a,[{key:"digest",value:function(){var a=this;setTimeout(function(){requestAnimationFrame(a.digest.bind(a)),a.queue.length&&(a.readLn.call(a,a.queue[0]),a.queue.shift())},h["default"].digest)}},{key:"cancelDigest",value:function(){this.digesting=!1}},{key:"readLn",value:function(a){var b=[],c=this.commands.filter(function(c){var d=a.trim().match(c.command);return d&&(b=d.slice(1,d.length)),d});try{c[0].action.apply(self.robot,b)}catch(d){throw this.queue=[],new Error(d.message)}}},{key:"enqueue",value:function(a){this.queue=this.queue.concat(a.target.result.trim().split("\n"))}},{key:"loadFile",value:function(a){a.stopPropagation(),a.preventDefault(),document.documentElement.removeAttribute("data-file");var b=a.dataTransfer.files[0],c=new FileReader;c.onload=this.enqueue.bind(this),c.readAsText(b)}},{key:"addDropState",value:function(a){a.stopPropagation(),a.preventDefault(),document.documentElement.setAttribute("data-file","")}},{key:"removeDropState",value:function(a){a.stopPropagation(),a.preventDefault(),document.documentElement.removeAttribute("data-file")}},{key:"listen",value:function(){document.documentElement.addEventListener("dragover",this.addDropState.bind(this)),document.documentElement.addEventListener("dragend",this.removeDropState.bind(this)),document.documentElement.addEventListener("dragleave",this.removeDropState.bind(this)),document.documentElement.addEventListener("drop",this.loadFile.bind(this))}}]),a}();b["default"]=l,a.exports=b["default"]},function(a,b,c){a.exports={language:"en-GB",digest:1e3,grid:{container:"body",rows:5,columns:5,size:100,lines:{color:"rgba(0,0,0,0.3)",width:3}},robot:{name:"Robot",speed:1e3,position:{x:0,y:0,f:"NORTH"},hover:10,sounds:{move:"",rotate:""}},increment:90,headings:{NORTH:{r:0,x:0,y:1},EAST:{r:90,x:1,y:0},SOUTH:{r:180,x:0,y:-1},WEST:{r:270,x:-1,y:0}},mappings:{13:{command:"report"},32:{command:"place"},37:{command:"rotate",arguments:["left"]},38:{command:"move"},39:{command:"rotate",arguments:["right"]}},commands:[{name:"place",command:"^place$",action:"place"},{name:"place_at",command:"^place X?([0-9]+)\\,?\\s?Y?([0-9]+)\\,?\\s?(North|East|South|West)$",action:"place"},{name:"move",command:"^move$",action:"move"},{name:"left",command:"^left$",action:"left"},{name:"right",command:"^right$",action:"right"},{name:"report",command:"^report$",action:"report"}]}},function(a,b,c){!function(b,c){a.exports=c()}("Mumble",function(){"use strict";var a=function(a){function b(a){if(j=h(),o.isAvailable()){if(a)for(var b in n)a[b]&&(n[b]=a[b]);o.setLanguage(n.language),o.setContinuous(n.continuous),o.setAutoRestart(n.autoRestart),o.setMaxAlternatives(n.maxAlternatives),o.setDebug(n.debug),n.commands.forEach(function(a){o.addCommand(a.name,a.command,a.action)}),j.onstart=c,j.onend=d,j.onerror=e,j.onresult=f}}function c(a){i("Start listening..",a,n),g(n.callbacks.start,a,o)}function d(a){if(i("Stop listening..",a),g(n.callbacks.end,a,o),n.autoRestart&&!l){i("(Auto-restarting)");var b=(new Date).getTime()-k;1e3>b?setTimeout(o.start,1e3-b):o.start()}}function e(a){i("Error occurred",a),g(n.callbacks.error,a,o),-1!==["not-allowed","service-not-allowed"].indexOf(a.error)&&o.setAutoRestart(!1)}function f(a){i("Got result",a),g(n.callbacks.speech,a,o);for(var b=a.results[a.resultIndex],c=!1,d=0;d<b.length;d++){var e=b[d],f=e.transcript.trim();if(i('Recognized: "%s"',f),c=m.some(function(b){var c=b.command.exec(f);if(c){var d=c.slice(1);return i('Command matched: "%s", %s',b.name,b.command,d),g(n.callbacks.recognizeMatch,a,o),b.action.apply(o,d),!0}return!1}))break}return c||g(n.callbacks.recognizeNoMatch,a,o),c}function g(a,b,c){"function"==typeof a&&a.call(c,b)}function h(){var a=window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition;return a?new a:(i("SpeechRecognition object not supported"),null)}function i(){if(n.debug){var a=window.console||{log:function(){}};a.log.apply(a,arguments)}}var j=null,k=0,l=!1,m=[],n={language:"en-US",autoRestart:!0,continuous:"http:"===window.location.protocol,maxAlternatives:5,debug:!1,commands:[],callbacks:{start:null,end:null,speech:null,recognizeMatch:null,recognizeNoMatch:null,error:null}},o=this;this.start=function(){if(!this.isAvailable())throw"Speech recognition not supported in this browser";l=!1,k=(new Date).getTime(),i("Starting with %d command(s) active",m.length),j.start()},this.stop=function(){this.isAvailable()&&(l=!0,j.abort())},this.isAvailable=function(){return!!j},this.getSpeechRecognitionObject=function(){return j},this.addCommand=function(a,b,c){if(this.getCommand(a))throw'Command "'+a+'"" already exists';var d="string"==typeof b?"^"+b+"$":b.source,e=new RegExp(d,"i");m.push({name:a,command:e,action:c}),i('Added command: "%s", %s',a,e)},this.removeCommand=function(a){var b=-1;m.some(function(c,d){return c.name==a?(b=d,!0):!1}),b>=0&&(delete m[b],i('Removed command "%s"',a))},this.getCommand=function(a){var b=null;return m.some(function(c){return c.name==a?(b=c,!0):!1}),b},this.setLanguage=function(a){n.language=a,this.isAvailable()&&(j.lang=n.language)},this.setAutoRestart=function(a){n.autoRestart=!!a},this.setMaxAlternatives=function(a){n.maxAlternatives=parseInt(a),this.isAvailable()&&(j.maxAlternatives=n.maxAlternatives)},this.setContinuous=function(a){n.continuous=!!a,this.isAvailable()&&(j.continuous=n.continuous)},this.setDebug=function(a){n.debug=!!a},b(a)};return a})},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(2),h=d(g),i=c(5),j=d(i),k=c(6),l=d(k);Object.freeze(h["default"]);var m=function(){function a(b){e(this,a),l["default"](this,h["default"].robot,b),this.placed=!1,this.moving=!1,this.robot=null,this.queue=[]}return f(a,[{key:"render",value:function(){this.robot=document.createElement("div"),this.robot.style.width=this.robot.style.height=""+.6*this.grid.size+"px",this.robot.style.margin=""+.2*this.grid.size+"px",this.robot.id="robot",this.grid.el.appendChild(this.robot)}},{key:"animate",value:function(){this.robot.style.transform="translate3d("+this.position.x*this.grid.size+"px, -"+this.position.y*this.grid.size+"px, "+h["default"].robot.hover+"px) rotate("+this.position.a+"deg)",this.robot.style.webkitTransform="translate3d("+this.position.x*this.grid.size+"px, -"+this.position.y*this.grid.size+"px, "+h["default"].robot.hover+"px) rotate("+this.position.a+"deg)",this.robot.setAttribute("data-heading",this.position.f.toLowerCase())}},{key:"connectTo",value:function(a){if(a instanceof j["default"]==!1)throw new Error("first argument must be a grid instance");this.grid=a}},{key:"validateX",value:function(a){return"number"==typeof a&&a<this.grid.columns&&a>=0?!0:!1}},{key:"validateY",value:function(a){return"number"==typeof a&&a<this.grid.rows&&a>=0?!0:!1}},{key:"validateF",value:function(a){return"string"==typeof a&&"object"==typeof h["default"].headings[a]?!0:!1}},{key:"place",value:function(){var a=void 0===arguments[0]?0:arguments[0],b=void 0===arguments[1]?0:arguments[1],c=void 0===arguments[2]?"NORTH":arguments[2],d=parseInt(a),e=parseInt(b),f=c.toUpperCase();this.position.x=this.validateX(d)?d:h["default"].robot.position.x,this.position.y=this.validateY(e)?e:h["default"].robot.position.y,this.position.f=this.validateF(f)?f:h["default"].robot.position.f,this.position.r=this.validateF(f)?h["default"].headings[f].r:h["default"].headings[h["default"].robot.position.f].r,this.position.a=this.validateF(f)?h["default"].headings[f].r:h["default"].headings[h["default"].robot.position.f].r,this.placed===!1&&(this.render(),this.placed=!0),this.animate()}},{key:"move",value:function(){if(this.placed!==!0)throw new Error(this.name+" has not been placed.");var a=h["default"].headings[this.position.f];this.position.x=this.validateX(this.position.x+a.x)?this.position.x+a.x:this.position.x,this.position.y=this.validateY(this.position.y+a.y)?this.position.y+a.y:this.position.y,this.animate()}},{key:"rotate",value:function(a){if(this.placed!==!0)throw new Error(this.name+" has not been placed.");"left"===a?(this.position.a-=h["default"].increment,this.position.r-=h["default"].increment,this.position.r<0?this.position.r+=360:this.position.r>=360&&(this.position.r-=360)):"right"===a&&(this.position.a+=h["default"].increment,this.position.r+=h["default"].increment,this.position.r<0?this.position.r+=360:this.position.r>=360&&(this.position.r-=360));for(var b in h["default"].headings)this.position.r===h["default"].headings[b].r&&(this.position.f=b);this.animate()}},{key:"left",value:function(){this.rotate("left")}},{key:"right",value:function(){this.rotate("right")}},{key:"report",value:function(){var a={coords:!1,message:!1};this.placed===!0?(a.coords={X:this.position.x,Y:this.position.y,F:this.position.f},a.message=""+this.name+" is at X"+this.position.x+", Y"+this.position.y+" and facing "+this.position.f.toLowerCase()):(a.coords=!1,a=""+this.name+" is not yet on the board");var b=new CustomEvent("broadcast",{detail:a});document.dispatchEvent(b)}},{key:"listen",value:function(){document.addEventListener("keydown",this.handleKeypress.bind(this)),document.addEventListener("click",this.handleClick.bind(this))}},{key:"handleKeypress",value:function(a){var b=h["default"].mappings[a.which];if("INPUT"!==a.target.nodeName&&this.moving===!1&&b&&"function"==typeof this[b.command]){a.preventDefault();b.arguments||[];this[b.command].apply(this,b.arguments)}}},{key:"handleClick",value:function(a){if(a.target.getAttribute("data-action")&&this.moving===!1){a.preventDefault(),a.stopPropagation();var b=a.target.getAttribute("data-action");"function"==typeof this[b]&&this[b]()}}},{key:"registerCommands",value:function(){var a=this,b=h["default"].commands.map(function(b){var c={name:b.name,command:new RegExp(b.command,"i"),action:function(){a[b.action].apply(a,arguments)}};return c});return b}}]),a}();b["default"]=m,a.exports=b["default"]},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(2),h=d(g),i=c(6),j=d(i);Object.freeze(h["default"]);var k=null,l=null,m=function(){function a(b){e(this,a),j["default"](this,h["default"].grid,b),this.el=document.querySelector(this.container),this.offsetX=0,this.offsetY=0}return f(a,[{key:"createCanvas",value:function(){this.canvas=document.createElement("canvas"),this.el.appendChild(this.canvas),this.canvas.draggable=!0,this.canvas.width=this.columns*this.size,this.canvas.height=this.rows*this.size,this.ctx=this.canvas.getContext("2d")}},{key:"layout",value:function(){if(this.ctx.strokeStyle=this.lines.color,this.ctx.lineWidth=this.lines.width,!this.ctx||!this.ctx instanceof CanvasRenderingContext2D)throw new Error("Grid.ctx is not a canvas element");for(var a=0;a<this.rows;a++)for(var b=0;b<this.columns;b++)this.draw(b,a)}},{key:"draw",value:function(a,b){var c=a*this.size+this.lines.width/2,d=b*this.size+this.lines.width/2,e=this.size-this.lines.width,f=this.size-this.lines.width;this.ctx.strokeRect(c,d,e,f)}},{key:"checkTouch",value:function(a){return a.changedTouches?a.changedTouches[0]:a}},{key:"startRotate",value:function(a){a.target===this.canvas&&(a.preventDefault(),k=this.checkTouch(a).pageX-this.offsetX,l=this.checkTouch(a).pageY-this.offsetY,document.documentElement.setAttribute("data-dragging",""))}},{key:"stopRotate",value:function(a){(k||l)&&(a.preventDefault(),k=null,l=null,document.documentElement.removeAttribute("data-dragging"))}},{key:"rotate",value:function(a){k&&l&&(a.preventDefault(),this.offsetX=this.clamp(this.checkTouch(a).pageX-k,60),this.offsetY=this.clamp(this.checkTouch(a).pageY-l,60,0),this.canvas.parentNode.style.transform="perspective(1000px) rotateX("+this.offsetY+"deg) rotateZ("+this.offsetX+"deg)",this.canvas.parentNode.style.webkitTransform="perspective(1000px) rotateX("+this.offsetY+"deg) rotateZ("+this.offsetX+"deg)")}},{key:"clamp",value:function(a){var b=void 0===arguments[1]?60:arguments[1],c=void 0===arguments[2]?60:arguments[2];return a>b?b:-c>a?-c:a}},{key:"listen",value:function(){document.addEventListener("mousedown",this.startRotate.bind(this)),document.addEventListener("mousemove",this.rotate.bind(this)),document.addEventListener("mouseup",this.stopRotate.bind(this)),document.addEventListener("touchstart",this.startRotate.bind(this)),document.addEventListener("touchmove",this.rotate.bind(this)),document.addEventListener("touchend",this.stopRotate.bind(this))}}]),a}();b["default"]=m,a.exports=b["default"]},function(a,b,c){"use strict";function d(a){if(null==a)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}a.exports=Object.assign||function(a,b){for(var c,e,f=d(a),g=1;g<arguments.length;g++){c=arguments[g],e=Object.keys(Object(c));for(var h=0;h<e.length;h++)f[e[h]]=c[e[h]]}return f}},function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b){d(this,a);try{this.container=document.querySelector(b)}catch(c){return console.error("No container was specified for the reporter")}}return e(a,[{key:"report",value:function(a){console.log(a.detail.coords),this.listItem(a.detail.message)}},{key:"listItem",value:function(a){var b=document.createElement("li");b.innerHTML=a,this.container.insertBefore(b,this.container.firstChild)}},{key:"listen",value:function(){document.addEventListener("broadcast",this.report.bind(this))}}]),a}();b["default"]=f,a.exports=b["default"]},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(2),h=d(g),i=c(3),j=d(i),k=c(4),l=d(k);Object.freeze(h["default"]);var m=function(){function a(b){if(e(this,a),!b instanceof l["default"])throw new Error("Parser needs to connect to an instantiated robot");this.robot=b,this.commands=this.robot.registerCommands(),this.mumble=new j["default"]({language:h["default"].language,commands:this.commands})}return f(a,[{key:"listen",value:function(){this.mumble.start()}}]),a}();b["default"]=m,a.exports=b["default"]},function(a,b,c){var d;!function(){"use strict";function e(a,b){function c(a,b){return function(){return a.apply(b,arguments)}}var d;if(b=b||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=b.touchBoundary||10,this.layer=a,this.tapDelay=b.tapDelay||200,this.tapTimeout=b.tapTimeout||700,!e.notNeeded(a)){for(var f=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],h=this,i=0,j=f.length;j>i;i++)h[f[i]]=c(h[f[i]],h);g&&(a.addEventListener("mouseover",this.onMouse,!0),a.addEventListener("mousedown",this.onMouse,!0),a.addEventListener("mouseup",this.onMouse,!0)),a.addEventListener("click",this.onClick,!0),a.addEventListener("touchstart",this.onTouchStart,!1),a.addEventListener("touchmove",this.onTouchMove,!1),a.addEventListener("touchend",this.onTouchEnd,!1),a.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(a.removeEventListener=function(b,c,d){var e=Node.prototype.removeEventListener;"click"===b?e.call(a,b,c.hijacked||c,d):e.call(a,b,c,d)},a.addEventListener=function(b,c,d){var e=Node.prototype.addEventListener;"click"===b?e.call(a,b,c.hijacked||(c.hijacked=function(a){a.propagationStopped||c(a)}),d):e.call(a,b,c,d)}),"function"==typeof a.onclick&&(d=a.onclick,a.addEventListener("click",function(a){d(a)},!1),a.onclick=null)}}var f=navigator.userAgent.indexOf("Windows Phone")>=0,g=navigator.userAgent.indexOf("Android")>0&&!f,h=/iP(ad|hone|od)/.test(navigator.userAgent)&&!f,i=h&&/OS 4_\d(_\d)?/.test(navigator.userAgent),j=h&&/OS [6-7]_\d/.test(navigator.userAgent),k=navigator.userAgent.indexOf("BB10")>0;e.prototype.needsClick=function(a){switch(a.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(a.disabled)return!0;break;case"input":if(h&&"file"===a.type||a.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(a.className)},e.prototype.needsFocus=function(a){switch(a.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!g;case"input":switch(a.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!a.disabled&&!a.readOnly;default:return/\bneedsfocus\b/.test(a.className)}},e.prototype.sendClick=function(a,b){var c,d;document.activeElement&&document.activeElement!==a&&document.activeElement.blur(),d=b.changedTouches[0],c=document.createEvent("MouseEvents"),c.initMouseEvent(this.determineEventType(a),!0,!0,window,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null),c.forwardedTouchEvent=!0,a.dispatchEvent(c)},e.prototype.determineEventType=function(a){return g&&"select"===a.tagName.toLowerCase()?"mousedown":"click"},e.prototype.focus=function(a){var b;h&&a.setSelectionRange&&0!==a.type.indexOf("date")&&"time"!==a.type&&"month"!==a.type?(b=a.value.length,a.setSelectionRange(b,b)):a.focus()},e.prototype.updateScrollParent=function(a){var b,c;if(b=a.fastClickScrollParent,!b||!b.contains(a)){c=a;do{if(c.scrollHeight>c.offsetHeight){b=c,a.fastClickScrollParent=c;break}c=c.parentElement}while(c)}b&&(b.fastClickLastScrollTop=b.scrollTop)},e.prototype.getTargetElementFromEventTarget=function(a){return a.nodeType===Node.TEXT_NODE?a.parentNode:a},e.prototype.onTouchStart=function(a){var b,c,d;if(a.targetTouches.length>1)return!0;if(b=this.getTargetElementFromEventTarget(a.target),c=a.targetTouches[0],h){if(d=window.getSelection(),d.rangeCount&&!d.isCollapsed)return!0;if(!i){if(c.identifier&&c.identifier===this.lastTouchIdentifier)return a.preventDefault(),!1;this.lastTouchIdentifier=c.identifier,this.updateScrollParent(b)}}return this.trackingClick=!0,this.trackingClickStart=a.timeStamp,this.targetElement=b,this.touchStartX=c.pageX,this.touchStartY=c.pageY,a.timeStamp-this.lastClickTime<this.tapDelay&&a.preventDefault(),!0},e.prototype.touchHasMoved=function(a){var b=a.changedTouches[0],c=this.touchBoundary;return Math.abs(b.pageX-this.touchStartX)>c||Math.abs(b.pageY-this.touchStartY)>c?!0:!1},e.prototype.onTouchMove=function(a){return this.trackingClick?((this.targetElement!==this.getTargetElementFromEventTarget(a.target)||this.touchHasMoved(a))&&(this.trackingClick=!1,this.targetElement=null),!0):!0},e.prototype.findControl=function(a){return void 0!==a.control?a.control:a.htmlFor?document.getElementById(a.htmlFor):a.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},e.prototype.onTouchEnd=function(a){var b,c,d,e,f,k=this.targetElement;if(!this.trackingClick)return!0;if(a.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(a.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=a.timeStamp,c=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,j&&(f=a.changedTouches[0],k=document.elementFromPoint(f.pageX-window.pageXOffset,f.pageY-window.pageYOffset)||k,k.fastClickScrollParent=this.targetElement.fastClickScrollParent),d=k.tagName.toLowerCase(),"label"===d){if(b=this.findControl(k)){if(this.focus(k),g)return!1;k=b}}else if(this.needsFocus(k))return a.timeStamp-c>100||h&&window.top!==window&&"input"===d?(this.targetElement=null,!1):(this.focus(k),this.sendClick(k,a),h&&"select"===d||(this.targetElement=null,a.preventDefault()),!1);return h&&!i&&(e=k.fastClickScrollParent,e&&e.fastClickLastScrollTop!==e.scrollTop)?!0:(this.needsClick(k)||(a.preventDefault(),this.sendClick(k,a)),!1)},e.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},e.prototype.onMouse=function(a){return this.targetElement?a.forwardedTouchEvent?!0:a.cancelable&&(!this.needsClick(this.targetElement)||this.cancelNextClick)?(a.stopImmediatePropagation?a.stopImmediatePropagation():a.propagationStopped=!0,a.stopPropagation(),a.preventDefault(),!1):!0:!0},e.prototype.onClick=function(a){var b;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===a.target.type&&0===a.detail?!0:(b=this.onMouse(a),b||(this.targetElement=null),b)},e.prototype.destroy=function(){var a=this.layer;g&&(a.removeEventListener("mouseover",this.onMouse,!0),a.removeEventListener("mousedown",this.onMouse,!0),a.removeEventListener("mouseup",this.onMouse,!0)),a.removeEventListener("click",this.onClick,!0),a.removeEventListener("touchstart",this.onTouchStart,!1),a.removeEventListener("touchmove",this.onTouchMove,!1),a.removeEventListener("touchend",this.onTouchEnd,!1),a.removeEventListener("touchcancel",this.onTouchCancel,!1)},e.notNeeded=function(a){var b,c,d,e;if("undefined"==typeof window.ontouchstart)return!0;if(c=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!g)return!0;if(b=document.querySelector("meta[name=viewport]")){if(-1!==b.content.indexOf("user-scalable=no"))return!0;if(c>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(k&&(d=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),d[1]>=10&&d[2]>=3&&(b=document.querySelector("meta[name=viewport]")))){if(-1!==b.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===a.style.msTouchAction||"manipulation"===a.style.touchAction?!0:(e=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1],e>=27&&(b=document.querySelector("meta[name=viewport]"),b&&(-1!==b.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))?!0:"none"===a.style.touchAction||"manipulation"===a.style.touchAction?!0:!1)},e.attach=function(a,b){return new e(a,b)},d=function(){return e}.call(b,c,b,a),!(void 0!==d&&(a.exports=d))}()}]);